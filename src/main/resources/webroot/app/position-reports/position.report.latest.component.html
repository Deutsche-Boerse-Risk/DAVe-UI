<div class="row">
    <div class="col-lg-12">
        <h3>Position Reports</h3>
    </div>
    <!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">

                <div class="pull-right col-lg-2 filter">
                    <div class="input-group input-group-sm">
                        <input type="text" class="form-control"
                               placeholder="Filter ..." [(ngModel)]="filterQuery"
                               (ngModelChange)="filterAfterTimeout()">
                        <span class="input-group-btn">
                            <button class="btn btn-default" type="button" (click)="filter()">
                                <i class="fa fa-search" aria-hidden="true"></i>
                            </button>
                        </span>
                    </div>
                </div>

                <download-menu [columns]="exportKeys" [data]="data"
                               filename="download.csv"></download-menu>

                <bread-crumbs [routeParts]="routeParts"></bread-crumbs>
            </div>

            <initial-load *ngIf="initialLoad && !errorMessage"></initial-load>

            <no-data *ngIf="!initialLoad && !errorMessage && data?.length < 1"></no-data>

            <update-failed *ngIf="errorMessage" [message]="errorMessage"></update-failed>

            <data-table [data]="data"
                        [pageSize]="pageSize"
                        [defaultOrdering]="defaultOrdering">
                <column title="Member / Client"
                        sortingKey="member">
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportLatest', record.clearer | nullvalue:'*', record.member | nullvalue:'*']">
                            {{record.member}}
                        </a>
                    </template>
                </column>
                <column title="Account"
                        sortingKey="account">
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportLatest', record.clearer | nullvalue:'*', record.member | nullvalue:'*', record.account | nullvalue:'*']">
                            {{record.account}}
                        </a>
                    </template>
                </column>
                <column title="Symbol"
                        tooltip="Product symbol"
                        sortingKey="symbol">
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportLatest', routeParams['clearer'] | nullvalue:'*', routeParams['member'] | nullvalue:'*', record.account | nullvalue:'*', record.class | nullvalue:'*', record.symbol | nullvalue:'*']">
                            {{record.symbol}}
                        </a>
                    </template>
                </column>
                <column title="P/C"
                        tooltip="Put / Call flag (Options only)"
                        sortingKey="putCall">
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportLatest', routeParams['clearer'] | nullvalue:'*', routeParams['member'] | nullvalue:'*', routeParams['account'] | nullvalue:'*', record.class | nullvalue:'*', record.symbol | nullvalue:'*', record.putCall | nullvalue:'*']">
                            {{record.putCall}}
                        </a>
                    </template>
                </column>
                <column title="Strk"
                        tooltip="Strike (exercise) price (Options only)"
                        sortingKey="strikePrice">
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportLatest', routeParams['clearer'] | nullvalue:'*', routeParams['member'] | nullvalue:'*', routeParams['account'] | nullvalue:'*', record.class | nullvalue:'*', record.symbol | nullvalue:'*', record.putCall | nullvalue:'*', record.strikePrice | nullvalue:'*']">
                            {{record.strikePrice | number:'.2-2'}}
                        </a>
                    </template>
                </column>
                <column title="Opt"
                        tooltip="Version number (Options only)"
                        sortingKey="optAttribute">
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportLatest', routeParams['clearer'] | nullvalue:'*', routeParams['member'] | nullvalue:'*', routeParams['account'] | nullvalue:'*', record.class | nullvalue:'*', record.symbol | nullvalue:'*', record.putCall | nullvalue:'*', record.strikePrice | nullvalue:'*', record.optAttribute | nullvalue:'*']">
                            {{record.optAttribute}}
                        </a>
                    </template>
                </column>
                <column title="MMY"
                        tooltip="Maturity month and year"
                        sortingKey="maturityMonthYear">
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportLatest', routeParams['clearer'] | nullvalue:'*', routeParams['member'] | nullvalue:'*', routeParams['account'] | nullvalue:'*', record.class | nullvalue:'*', record.symbol | nullvalue:'*', record.putCall | nullvalue:'*', record.strikePrice | nullvalue:'*', record.optAttribute | nullvalue:'*', record.maturityMonthYear | nullvalue:'*']">
                            {{record.maturityMonthYear}}
                        </a>
                    </template>
                </column>
                <column title="NetLS"
                        tooltip="Net position"
                        sortingKey="netLS">
                    <template let-record="row" cell-template>
                        {{record.netLS | number:'.2-2'}}
                    </template>
                </column>
                <column title="Position VaR"
                        tooltip="PnL of the position when calculating portfolio VaR"
                        sortingKey="compVar">
                    <template let-record="row" cell-template>
                        {{record.compVar | number:'.2-2'}}
                    </template>
                </column>
                <column title="EuroDelta"
                        tooltip="Position sensibility to underlying move in Euro"
                        sortingKey="delta">
                    <template let-record="row" cell-template>
                        {{record.delta | number:'.2-2'}}
                    </template>
                </column>
                <column title="LA"
                        tooltip="Liquidity Addon of the position"
                        sortingKey="compLiquidityAddOn">
                    <template let-record="row" cell-template>
                        {{record.compLiquidityAddOn | number:'.2-2'}}
                    </template>
                </column>
                <column>
                    <template let-record="row" cell-template>
                        <a [routerLink]="['/positionReportHistory', record.clearer | nullvalue:'*', record.member | nullvalue:'*', record.account | nullvalue:'*', record.class | nullvalue:'*', record.symbol | nullvalue:'*', record.putCall | nullvalue:'*', record.strikePrice | nullvalue:'*', record.optAttribute | nullvalue:'*', record.maturityMonthYear | nullvalue:'*']">
                            <span class="fa fa-bar-chart-o" aria-hidden="true" title="Detail"></span>
                        </a>
                    </template>
                </column>
            </data-table>

            <!--<td>-->
            <!--<a><span class="fa fa-chevron-circle-down" aria-hidden="true" title="Show additional fields" id="extra-icon-{{record.functionalKey}}"></span></a>-->
            <!--<a routerLink="/positionReportHistory/{{record.clearer}}/{{record.member}}/{{record.account}}/{{record.clss}}/{{record.symbol}}/{{record.putCall | nullHandler:'*'}}/{{record.strikePrice | nullHandler:'*'}}/{{record.optAttribute | nullHandler:'*'}}/{{record.maturityMonthYear}}"><span class="fa fa-bar-chart-o" aria-hidden="true" title="Detail"></span></a>-->
            <!--</td>-->
            <!--</tr>-->
            <!--<tr ng-repeat-end class="hidden" id="extra-{{record.functionalKey}}">-->
            <!--<td colspan="14">-->
            <!--<table class="table table-condensed">-->
            <!--<thead>-->
            <!--<tr row-highlighter="record.functionalKey">-->
            <!--<th>Liqui Group / Margin Class</th>-->
            <!--<th>Clearing Ccy</th>-->
            <!--<th>Product Ccy</th>-->
            <!--<th>CrMrgLQty</th>-->
            <!--<th>CrMrgSQty</th>-->
            <!--<th>NetEA</th>-->
            <!--<th>OptExcQty</th>-->
            <!--<th>OptAssQty</th>-->
            <!--<th>AllTrQty</th>-->
            <!--<th>DelNtQty</th>-->
            <!--</tr>-->
            <!--</thead>-->
            <!--<tbody>-->
            <!--<tr row-highlighter="record.functionalKey">-->
            <!--<td highlighter="record.class"><a routerLink="/positionReportLatest/{{clearer}}/{{member}}/{{account}}/{{record.clss}}">{{record.clss}}</a></td>-->
            <!--<td highlighter="record.clearingCcy">{{record.clearingCcy}}</td>-->
            <!--<td highlighter="record.productCcy">{{record.productCcy}}</td>-->
            <!--<td highlighter="record.crossMarginLongQty">{{record.crossMarginLongQty | number:2}}</td>-->
            <!--<td highlighter="record.crossMarginShortQty">{{record.crossMarginShortQty | number:2}}</td>-->
            <!--<td highlighter="record.netEA">{{record.netEA | number:2}}</td>-->
            <!--<td highlighter="record.optionExcerciseQty">{{record.optionExcerciseQty | number:2}}</td>-->
            <!--<td highlighter="record.optionAssignmentQty">{{record.optionAssignmentQty | number:2}}</td>-->
            <!--<td highlighter="record.allocationTradeQty">{{record.allocationTradeQty | number:2}}</td>-->
            <!--<td highlighter="record.deliveryNoticeQty">{{record.deliveryNoticeQty | number:2}}</td>-->
            <!--</tr>-->
            <!--</tbody>-->
            <!--<thead>-->
            <!--<tr row-highlighter="record.functionalKey">-->
            <!--<th>CorrBreak</th>-->
            <!--<th>CopmError</th>-->
            <!--<th>LonOptCredit</th>-->
            <!--<th>PremPay</th>-->
            <!--<th>PremMrgn</th>-->
            <!--<th>Gamma</th>-->
            <!--<th>Vega</th>-->
            <!--<th>Rho</th>-->
            <!--<th>Theta</th>-->
            <!--<th>MVar</th>-->
            <!--</tr>-->
            <!--</thead>-->
            <!--<tbody>-->
            <!--<tr row-highlighter="record.functionalKey">-->
            <!--<td highlighter="record.compCorrelationBreak">{{record.compCorrelationBreak | number:2}}</td>-->
            <!--<td highlighter="record.compCompressionError">{{record.compCompressionError | number:2}}</td>-->
            <!--<td highlighter="record.compLongOptionCredit">{{record.compLongOptionCredit | number:2}}</td>-->
            <!--<td highlighter="record.variationMarginPremiumPayment">{{record.variationMarginPremiumPayment | number:2}}</td>-->
            <!--<td highlighter="record.premiumMargin">{{record.premiumMargin | number:2}}</td>-->
            <!--<td highlighter="record.gamma">{{record.gamma | number:2}}</td>-->
            <!--<td highlighter="record.vega">{{record.vega | number:2}}</td>-->
            <!--<td highlighter="record.rho">{{record.rho | number:2}}</td>-->
            <!--<td highlighter="record.theta">{{record.theta | number:2}}</td>-->
            <!--<td highlighter="record.mVar">{{record.mVar | number:2}}</td>-->
            <!--</tr>-->
            <!--</tbody>-->
            <!--</table>-->
        </div>
        <!-- /.panel -->
    </div>
    <!-- /.col-lg-12 -->
</div>